---
title: "CLARA"
author: "yincy"
date: "10/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**CLARA** (Clustering Large Applications) is an extension to k-medoids method to deal with data containing a large number of objects (more than several thousand observations) in order to reduce computing time and RAM storage problem.  

Instead of finding medoids for the entire data set, CLARA considers a small sample of the data with fixed size (sampsize) and applies the PAM algorithm to generate an optimal set of medoids for the sample.  

The quality of resulting medoids is measured by the average dissimilarity between every object in the entire data set and the medoid of its cluster, defined as the cost function.  

CLARA repeats the sampling and clustering processes a pre-specified number of times in order to minimize the sampling bias.  

**CLARA Algorithm**  

1. Split randomly the data sets in multiple subsets with fixed size (sampsize).  

2. Compute PAM algorithm on each subset and choose the corresponding k representatives objects (medoids). Assign each observation of the entire data set to the closest medoid.  
3. Calculate the mean (or the sum) of the dissimilarities of the observations to their closest medoid. This is used as a measure of the goodness of the clustering.  

4. Retain the sub-data set for which the mean (or sum) is miniaml. A further analysis is carried out on the final partition.  

### Example
```{r}
df <- rbind(cbind(rnorm(200, 0, 8), rnorm(200, 0, 8)), 
            cbind(rnorm(300, 50, 8), rnorm(300, 50, 8)))

colnames(df) <- c("x", "y")
rownames(df) <- paste("s", 1:nrow(df), sep = "")
df %>% head

# estimate the optimal number of clusters
fviz_nbclust(df, FUNcluster = cluster::clara, method = "silhouette") +
    theme_classic()

clara.res <- cluster::clara(x = df, k = 2, samples = 50, pamLike = TRUE)
clara.res
```

```{r}
fviz_cluster(object = clara.res, 
             palette = c("#00AFBB", "#FC4E07"), 
             ellipse.type = 't', 
             geom = "point", 
             pointsize = 1, 
             ggtheme = theme_classic())
```

















