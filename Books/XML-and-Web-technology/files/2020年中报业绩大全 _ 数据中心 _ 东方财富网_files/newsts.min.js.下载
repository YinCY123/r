/**
* 东财新闻推送
* publish time: 2019-4-10 14:16:20
*/
!function(n){var o={};function s(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=n,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s="./index.js")}({"./config/index.js":function(e,t){e.exports={get:function(e,t){return t==undefined&&(t="dev"),this[t][e]},dev:{styleurl:"http://auth.eastmoney.com:8080/css/ts.css",tspath:"http://115.236.103.104/sse"},test:{styleurl:"http://61.129.129.20/newsts/test/css/ts.css",tspath:"http://115.236.103.104/sse"},prod:{styleurl:"//emcharts.dfcfw.com/newsts/css/ts.css",tspath:""}}},"./index.js":function(e,t,n){n("./modules/polyfill/index.js");var o=n("./modules/icomet.js"),s=n("./modules/tsdiv.js"),r=n("./modules/url.js"),i=n("./config/index.js");n("./modules/addcssfile.js")(i.get("styleurl","prod"));var l=i.get("tspath","prod"),a="1"==r.getParam("tsdebug");a&&(window.newts_tsdiv=function(e,t){s(e,t,(new Date).getTime().toString())});var u=Math.floor(99*Math.random()+1).toString(),c=(self.location.protocol,"https://"+u+"."+"newspush.eastmoney.com/sub");""!=l&&(c=l);new o({channel:"bdc02c361aab973818f3583fb8b5e6d5",subUrl:c,callback:function(e){if(e)try{if(""!=(e=JSON.parse(e))&&e.Type!=undefined&&e.Data!=undefined)for(var t in m)m[t](e.Type,e.Data)}catch(n){}}});var m={},d={on:function(e,t){m[e]=t},off:function(e,t){delete m[e]}};d.on("default_news",function(e,t){"MajorNews"==e&&t.Art_Title&&t.Art_Url&&t.Art_Code&&s(t.Art_Title,t.Art_Url,t.Art_Code)}),d.testPush=function(e){for(var t in m)m[t](e.Type,e.Data)},window.EMPUSH=d},"./modules/addcssfile.js":function(e,t){e.exports=function(e){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href",e),t.appendChild(n)}},"./modules/browser.js":function(e,t){e.exports={isIE6:function(){return!(!document.all||window.XMLHttpRequest)}}},"./modules/icomet.js":function(t,n,o){var i=o("./modules/jsonp.js"),l=o("./modules/mini.js");t.exports=function e(o){var s=this;e.id__==undefined&&(e.id__=0),o.sub_url=o.sub_url||o.subUrl,o.pub_url=o.pub_url||o.pubUrl,o.sign_url=o.sign_url||o.signUrl,s.cname=o.channel,s.sub_cb=function(e){s.log("proc",JSON.stringify(e));var t=o.callback||o.sub_callback;if(t)try{t(e.content,e.type)}catch(n){s.log(n)}},s.sub_timeout=o.sub_timeout||6e4,s.id=e.id__++,s.cb="icomet_cb_"+s.id,s.timer=null,s.stopped=!0,s.last_msg_time=0,s.token="",s.data_seq=0,s.noop_seq=0,s.sign_cb=null,s.pub_url=o.pub_url,-1==o.sub_url.indexOf("?")?s.sub_url=o.sub_url+"?":s.sub_url=o.sub_url+"&",s.sub_url+="cb="+s.cb,o.sign_url&&(-1==o.sign_url.indexOf("?")?s.sign_url=o.sign_url+"?":s.sign_url=o.sign_url+"&",s.sign_url+="cb="+s.cb+"&cname="+s.cname),s.onmessage=function(e){if(e instanceof Array)for(var t in s.log("batch response",e.length),s.long_polling_pause=!0,e)s.proc_message(e[t]),t==e.length-1&&(s.long_polling_pause=!0);else s.proc_message(e)},s.proc_message=function(e){s.log("resp",JSON.stringify(e)),s.stopped||e&&(s.last_msg_time=(new Date).getTime(),"404"!=e.type?"401"!=e.type?"429"!=e.type?"sign"!=e.type?"noop"!=e.type?"next_seq"!=e.type?"data"!=e.type&&"broadcast"!=e.type||s.onmessage_data(e):s.onmessage_next_seq(e):s.onmessage_noop(e):s.sign_cb(e):r(5e3+5e3*Math.random()):alert("token error!"):alert("channel not exists!"))},s.onmessage_noop=function(e){e.seq==s.noop_seq?(2147483647==s.noop_seq?s.noop_seq=-2147483648:s.noop_seq++,r(1e3*Math.random())):s.log("ignore exceeded connections")},s.onmessage_next_seq=function(e){s.data_seq=e.seq,r()},s.onmessage_data=function(e){e.seq!=s.data_seq?(0==e.seq||1==e.seq?(s.log("server restarted"),s.sub_cb(e)):e.seq<s.data_seq?s.log("drop",e):(s.log("msg lost",e),s.sub_cb(e)),s.data_seq=e.seq):s.sub_cb(e),2147483647==s.data_seq?s.data_seq=-2147483648:s.data_seq++,r()};var r=function(e){var o=s.sub_url+"&cname="+s.cname+"&seq="+s.data_seq+"&noop="+s.noop_seq+"&token="+s.token+"&_="+(new Date).getTime();if("undefined"!=typeof EventSource){if(s.EventSource)return;s.stopped=!1,s.last_msg_time=(new Date).getTime(),o=o.replace("/sub?","/sse?"),s.log("sub SSE "+o);try{s.EventSource=new EventSource(o),s.EventSource.onmessage=function(e){s.onmessage(JSON.parse(e.data))},s.EventSource.onerror=function(){s.log("EventSource error"),s.EventSource.close(),s.EventSource=null}}catch(t){s.log(t.message)}}else{if(s.long_polling_pause)return;e|=0,setTimeout(function(){s.stopped=!1,s.last_msg_time=(new Date).getTime();for(var e=l(".jsonp_icomet"),t=0,n=e.length;t<n;++t)document.getElementsByTagName("head")[0].removeChild(e[0]);s.log("sub Long-Polling "+o),i(o,{},s.cb,function(e){})},e)}};s.sign_cb=function(e){if(!s.stopped){s.cname=e.cname,s.token=e.token;try{var t=parseInt(e.sub_timeout)||0;s.sub_timeout=1.3*t*1e3}catch(n){}r()}},s.start=function(){if(window[s.cb]=s.onmessage,s.log("start"),s.stopped=!1,s.last_msg_time=(new Date).getTime(),s.timer||(s.timer=setInterval(function(){(new Date).getTime()-s.last_msg_time>s.sub_timeout&&(s.log("timeout"),s.stop(),s.start())},1e3)),s.sign_url){s.log("sign in icomet server...");var e=s.sign_url+"&_="+(new Date).getTime();$.ajax({url:e,dataType:"jsonp",jsonpCallback:s.cb})}else r()},s.stop=function(){s.log("stop"),s.stopped=!0,s.last_msg_time=0,s.timer&&(clearTimeout(s.timer),s.timer=null),s.EventSource&&(s.EventSource.close(),s.EventSource=undefined)},s.pub=function(e,t){if("string"!=typeof e||!s.pub_url)return alert(s.pub_url),!1;t==undefined&&(t=function(){});var n={};n.cname=s.cname,n.content=e,$.getJSON(s.pub_url,n,t)},s.log=function(){return!1},s.start()}},"./modules/jsonp.js":function(e,t){e.exports=function(e,t,n,o){e=e||"",n=n||"",o=o||function(){};if("object"==typeof(t=t||{})){for(var s="",r=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}(t),i=0;i<r.length;i++)s+=encodeURIComponent(r[i])+"="+encodeURIComponent(t[r[i]]),i!=r.length-1&&(s+="&");e+="?"+s}else"function"==typeof t&&(o=n=t);"function"==typeof n&&(o=n,n="callback"),Date.now||(Date.now=function(){return(new Date).getTime()});var l=Date.now(),a="jsonp"+Math.round(l+1000001*Math.random());window[a]=function(e){o(e);try{delete window[a]}catch(t){window[a]=undefined}try{document.getElementById(a).parentNode.removeChild(document.getElementById(a))}catch(n){}},-1===e.indexOf("?")?e+="?":e+="&";var u=document.createElement("script");u.id=a,u.className="jsonp_icomet",u.setAttribute("src",e+n+"="+a),document.getElementsByTagName("head")[0].appendChild(u)}},"./modules/mini.js":function(e,t){var n=function(){var g=/(?:[\w\-\\.#]+)+(?:\[\w+?=([\'"])?(?:\\\1|.)+?\1\])?|\*|>/gi,h=/^(?:[\w\-_]+)?\.([\w\-_]+)/,_=/^(?:[\w\-_]+)?#([\w\-_]+)/,b=/^([\w\*\-_]+)/,y=[null,null];function v(e){try{return Array.prototype.slice.call(e)}catch(s){for(var t=[],n=0,o=e.length;n<o;++n)t[n]=e[n];return t}}var o,i,l,w=(i=+new Date,o=1,l=function(e){var t=e[i],n=o++;return!t&&(e[i]=n,!0)},function(e){for(var t,n=e.length,o=[],s=-1,r=0;r<n;++r)t=e[r],l(t)&&(o[++s]=t);return i+=1,o});return function t(n,o){if(o=o||document,!/^[\w\-_#]+$/.test(n)&&o.querySelectorAll)return v(o.querySelectorAll(n));if(-1<n.indexOf(",")){for(var s=n.split(/,/g),r=[],i=0,l=s.length;i<l;++i)r=r.concat(t(s[i],o));return w(r)}var a,u=n.match(g),c=u.pop(),m=(c.match(_)||y)[1],d=!m&&(c.match(h)||y)[1],f=!m&&(c.match(b)||y)[1];if(d&&!f&&o.getElementsByClassName)a=v(o.getElementsByClassName(d));else if(a=!m&&v(o.getElementsByTagName(f||"*")),d&&(a=function(e,t,n){for(var o,s=-1,r=-1,i=[];o=e[++s];)n.test(o[t])&&(i[++r]=o);return i}(a,"className",RegExp("(^|\\s)"+d+"(\\s|$)"))),m){var p=o.getElementById(m);return p?[p]:[]}return u[0]&&a[0]?function e(t,n,o){var s=t.pop();if(">"===s)return e(t,n,!0);var r,i,l,a=[],u=-1,c=(s.match(_)||y)[1],m=!c&&(s.match(h)||y)[1],d=!c&&(s.match(b)||y)[1],f=-1;for(d=d&&d.toLowerCase();r=n[++f];){i=r.parentNode;do{if(l=(l=(l=!d||"*"===d||d===i.nodeName.toLowerCase())&&(!c||i.id===c))&&(!m||RegExp("(^|\\s)"+m+"(\\s|$)").test(i.className)),o||l)break}while(i=i.parentNode);l&&(a[++u]=r)}return t[0]&&a[0]?e(t,a):a}(u,a):a}}();e.exports=n},"./modules/polyfill/JSON.js":function(module,exports){var Ac,Bc,Cc,Dc,Ec;window.JSON||(window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:(Ac=Object.prototype.toString,Bc=Array.isArray||function(e){return"[object Array]"===Ac.call(e)},Cc={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},Dc=function(e){return Cc[e]||"\\u"+(e.charCodeAt(0)+65536).toString(16).substr(1)},Ec=/[\\"\u0000-\u001F\u2028\u2029]/g,function e(t){if(null==t)return"null";if("number"==typeof t)return isFinite(t)?t.toString():"null";if("boolean"==typeof t)return t.toString();if("object"==typeof t){if("function"==typeof t.toJSON)return e(t.toJSON());if(Bc(t)){for(var n="[",o=0;o<t.length;o++)n+=(o?", ":"")+e(t[o]);return n+"]"}if("[object Object]"===Ac.call(t)){var s=[];for(var r in t)t.hasOwnProperty(r)&&s.push(e(r)+": "+e(t[r]));return"{"+s.join(", ")+"}"}}return'"'+t.toString().replace(Ec,Dc)+'"'})})},"./modules/polyfill/console.js":function(e,t){!function(e){"use strict";e.console||(e.console={});for(var t,n,o=e.console,s=function(){},r=["memory"],i="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=r.pop();)o[t]||(o[t]={});for(;n=i.pop();)o[n]||(o[n]=s)}("undefined"==typeof window?this:window)},"./modules/polyfill/index.js":function(e,t,n){n("./modules/polyfill/console.js"),n("./modules/polyfill/JSON.js")},"./modules/tsdiv.js":function(e,t,n){var o=n("./modules/browser.js"),s=[];function r(e,t){this.html=document.createElement("div"),this.html.className="newsts",this.html.innerHTML='<div class="newstsla"><a href="http://www.eastmoney.com/" target="_blank">快讯</a></div><a class="newstslink" href="'+t+'" target="_blank">'+e+"</a>",this.close_html=document.createElement("div"),this.close_html.className="newstsclose",this.close_html.innerHTML="<span></span>",this.html.appendChild(this.close_html),this.bind()}r.prototype.show=function(){this.closeAll(),s.push(this.html);var e=55*(s.length-1)+5+80;document.body.appendChild(this.html),o.isIE6()?(this.html.style.left=Math.floor((document.body.clientWidth-this.html.clientWidth)/2).toString()+"px",this.html.style.marginTop=Math.floor(document.documentElement.clientHeight-55-e).toString()+"px"):(this.html.style.bottom=e+"px",this.html.style.marginLeft="-"+Math.floor(this.html.clientWidth/2).toString()+"px")},r.prototype.bind=function(){var e=this,t=setTimeout(function(){e.close()},3e5);this.close_html.onclick=function(){clearTimeout(t),e.close()},this.html.getElementsByTagName("a")[1].onclick=function(){try{window.sendTrackLog("a","click","xwts_kxtc")}catch(e){}}},r.prototype.close=function(){for(var e=0;e<s.length;e++)if(s[e]===this.html){s.splice(e,1);break}if(0<s.length)for(e=0;e<s.length;e++)o.isIE6()?s[e].style.marginTop=Math.floor(document.documentElement.clientHeight-55-55*e).toString()+"px":s[e].style.bottom=55*e+5+"px";try{this.html.parentNode.removeChild(this.html)}catch(t){}},r.prototype.closeAll=function(){for(var e=0;e<s.length;e++)s[e].parentNode.removeChild(s[e]);s=[]};var i=[];e.exports=function(e,t,n){for(var o=0;o<i.length;o++)if(n==i[o])return!1;var s=new r(e,t);i.push(n),s.show()}},"./modules/url.js":function(e,t){e.exports={getParam:function(e){var t=location.search,n={};if(""!=t)for(var o,s,r=(t=t.substring(1,t.length)).split("&"),i=0;i<r.length;i++)o=r[i].substring(0,r[i].indexOf("=")),s=r[i].substring(r[i].indexOf("=")+1,r[i].length),n[o]=s;return"undefined"!=typeof n[e]?n[e]:null}}}});