---
title: "XML-and-Web-technology"
author: "yincy"
date: "7/2/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE, warning=FALSE}
library(XML)
library(rjson)
library(tidyverse)
```


# Chapter 1 Getting Started with XML and JSON  
## Reading from HTMLTables  
```{r}
u <- "/home/yincy/git/R-codes/Books/XML-and-Web-technology/files/List of countries and dependencies by population - Wikipedia.html"
tbls <- readHTMLTable(doc = u)
tbls %>% class()
```

```{r}
sapply(tbls, names)
sapply(tbls, nrow) # the large table is the population table
```

```{r}
pop <- readHTMLTable(doc = u, 
                     which = 1, 
                     header = T)
colnames(pop) <- c("Rank", "Country", "Population", "Percentage", "Date", "Source")
pop %>% head()
```


For each <table> node, `readHTMLTable()` loops over the row nodes (<tr>) and processes each cell in the row. These cells are either <th> or <td> elements for header or regular data, respectively.  

The data are typically in <td> elements, and we simply extract the contents of each cell as string.  

The <th> elements in a table typically indicate column header, and is used for variable names when appropriate.  


# Chapter 3 Parsing XML Content  
```{r}
doc <- xmlParse("files/sweat_metabolites.xml")
doc <- xmlParse(file = "files/sweat_metabolites.xml")
doc
```

```{r}
root <- xmlRoot(x = doc)
xmlSize(root)
xmlName(root)
xmlChildren(root) %>% length()
```

```{r}
meta1 <- root[["metabolite"]]
meta1[1]
```

```{r}
meta1[2]
```

```{r}
meta1[3]
```

```{r}
meta1 %>% xmlChildren() %>% length()
```


```{r}
root
```



```{r}
node <- xmlRoot(x = doc)[["metabolite"]]
sapply(xmlChildren(node), function(node) xmlValue(node[["status"]])) 
```





