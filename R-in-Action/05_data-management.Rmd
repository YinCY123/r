---
title: "05_data-management"
author: "yincy"
date: "3/9/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Probability functions
In R, probability functions take the form  
```
[dpqr]distribution_abbrevation()
```
d - density  
p - distribution function  
q - quantile function  
r - random generation  


|**distribution**|**abbrevation**|
|:--|:--|
|Beta|beta|
|Binomial|biom|
|Cauchy|cauchy|
|Chi-squared(noncentral)|chisq|
|Logistic|logis|
|Multinomial|multinom|
|Negative binomial|nbinom|
|Normal|norm|
|Exponential|exp|
|F|f|
|Gamma|gamma|
|Geometric|geom|
|Hypergeometric|hyper|
|Lognormal|lnorm|
|Poisson|pois|
|Wilcoxon signed rank|signrank|
|T|t|
|Uniform|unif|
|Weibull|weibull|
|Wilcoxon rank sum|wilcox|


---


# character functions
- nchar(x)  
- substr(x, start, stop)  
- grep(pattern, x, ignore.case = FALSE)  
- sub(pattern, replacement, x, ignore.case = FALSE)  
- strsplit(x, split, fixed = FALSE)  
    + if fixed = FALSE, then pattern is a *regular expression*. if fixed = TRUE, then pattern is a text string.  
- paste()  
- toupper(x)  
- tolower(x)  


---


```{r}
options(digits = 2)

english <- c(25, 22, 18, 15, 20, 28, 15, 30, 27, 18)
student <- c("John Davis", "Angela Williams", "Bullwinkle Moose", 
             "David Jones", "Janice Markhammer", "Cheryl Cushing", 
             "Reuven Ytzrhak", "Greg Knox", "Joel England",
             "Mary Rayburn")
math <- c(502, 600, 412, 358, 495, 512, 410, 625, 573, 522)
science <- c(95, 99, 80, 82, 75, 85, 80, 95, 89, 86)
roster <- data.frame(student, math, science, english, stringsAsFactors = F)
z <- scale(roster[, 2:4])
score <- apply(z, 1, mean)
roster <- cbind(roster, score)

y <- quantile(score, probs = c(0.8, 0.6, 0.4, 0.2))
roster$grade <- NA
roster$grade[score >= y[1]] <- "A"
roster$grade[score < y[1] & score >= y[2]] <- "B"
roster$grade[score < y[2] & score >= y[3]] <- "C"
roster$grade[score < y[3] & score >= y[4]] <- "D"
roster$grade[score < y[4]] <- "F"

name <- strsplit(roster$student, split = " ")
lastname <- sapply(name, "[", 2)
firstname <- sapply(name, "[", 1)
roster <- cbind(firstname, lastname, roster[, -1])
roster <- roster[order(lastname, firstname), ]
```


## switch
`switch` chooses statements based on the value of an expression.  
```
switch(expr, ...)
```

```{r}
feelings <- c("sad", "afraid")
for(i in feelings){
    print(
        switch(i, 
               happy = "I am glad you are happy", 
               afraid = "There is nothing to fear", 
               sad = "Cheer up", 
               angry = "Calm down now")
    )
}
```

```{r}
mydate <- function(type = "long"){
    switch(type, 
           long = format(Sys.time(), "%A %B %d %Y"), 
           short = format(Sys.time(), "%m-%d-%y"), 
           cat(type, "is not a recognized type\n"))
}

mydate(type = "long")
mydate(type = "short")
mydate(type = "median")
```

The `t()` function always returns a matrix.  


## Aggregating data
```{r}
options(digits = 3)

aggdata <- aggregate(mtcars, 
                     by = list(Cylinders = mtcars$cyl, Gears = mtcars$gear), # rename variables
                     FUN = mean, 
                     na.rm = TRUE)
aggdata
```

```{r}
library(dplyr)

mtcars %>% 
    group_by(cyl, gear) %>% 
    summarise_all(.funs = list(mean), na.rm = TRUE)
```















